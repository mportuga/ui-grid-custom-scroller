/*! 
 * ui-grid-custom-scroller - v1.0.0 - 2016-12-09
 * git+https://github.com/mportuga/ui-grid-custom-scroller.git
 * Copyright (c) 2016 ; License: MIT
 */
!function(){"use strict";angular.module("ui.grid.customScroller",["ui.grid"]),angular.module("ui.grid.customScroller").constant("uiGridScrollerConstants",{deceleration:7e-4,scrollType:{NONE:0,TOUCHABLE:1,MOUSE:2,POINTER:3}}),angular.module("ui.grid.customScroller").factory("uiGridScroller",["$window","gridUtil","uiGridScrollerConstants",function(a,b,c){function d(f,g){function i(a){var b=a.touches?a.touches[0]:a;f.off("scroll",g),d.initiated=v[a.type],o=b.pageX,p=b.pageY,q=(new Date).getTime(),r=f[0].scrollLeft,s=f[0].scrollTop,d.isAnimating=!1}function j(a,b,c){var d=a+b;return(d<0||d>n()[c])&&(d=d<0?0:n()[c]),d}function k(a){if(a.preventDefault(),v[a.type]===d.initiated){var b,c,h=(new Date).getTime(),i=a.touches?a.touches[0]:a,k=o-i.pageX,l=p-i.pageY;o=i.pageX,p=i.pageY,b=j(f[0].scrollLeft,k,"x"),c=j(f[0].scrollTop,l,"y"),h-q>300&&(q=(new Date).getTime(),r=b,s=c),e(b,c,f),g.call(null,a)}}function l(a){if(v[a.type]===d.initiated){var b=(new Date).getTime()-q,e=m(f[0].scrollLeft,r,b),i=m(f[0].scrollTop,s,b),j=e.destination,k=i.destination,l=Math.max(e.duration,i.duration);h(j,k,l,f,g.bind(null,a)),d.initiated=c.scrollType.NONE}}function m(a,b,d){a=Math.abs(a),b=Math.abs(b);var e=a-b,f=Math.abs(e)/d,g=a+f*f/(2*c.deceleration)*(e>=0?1:-1),h=f/c.deceleration;return{destination:Math.round(g),duration:h}}function n(){return t||(t={x:u.offsetWidth-f[0].clientWidth,y:u.offsetHeight-f[0].clientHeight}),t}var o,p,q,r,s,t,u=f[0].children[0],v={touchstart:c.scrollType.TOUCHABLE,touchmove:c.scrollType.TOUCHABLE,touchend:c.scrollType.TOUCHABLE,touchcancel:c.scrollType.TOUCHABLE};"onmousedown"in a&&f.on("scroll",g),b.isTouchEnabled()&&(f.on("touchstart",i),f.on("touchmove",k),f.on("touchcancel",l),f.on("touchend",l))}function e(a,b,c){c[0].scrollLeft=a,c[0].scrollTop=b}function f(a){return a*(2-a)}function g(a,b,c){return(a-Math.abs(c))*b+Math.abs(c)}function h(a,b,c,h,i){function j(){var o,p,q,r,s=(new Date).getTime();return s>=n?(d.isAnimating=!1,e(a,b,h),void h.on("scroll",i)):(o=(s-k)/c,p=f(o),q=g(a,p,l),r=g(b,p,m),e(q,r,h),i.call(),void(d.isAnimating&&angular.isFunction(window.requestAnimationFrame)?window.requestAnimationFrame(j):h.on("scroll",i)))}var k=(new Date).getTime(),l=h[0].scrollLeft,m=h[0].scrollTop,n=k+c;d.isAnimating=!0,j()}return d.isAnimating=!1,d.initiated=c.scrollType.NONE,d}]),angular.module("ui.grid.customScroller").directive("uiGridCustomScroller",["uiGridScroller",function(a){return{restrict:"A",require:"uiGrid",scope:!1,compile:function(){return{pre:function(b,c,d,e){e.grid&&e.grid.options&&(e.grid.options.customScroller=a)},post:angular.noop}}}}])}();